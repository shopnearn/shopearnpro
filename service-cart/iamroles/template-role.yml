- Effect: "Allow"
  Action:
    - xray:PutTraceSegments
    - xray:PutTelemetryRecords
  Resource: '*'
- Effect: "Allow"
  Action:
    - dynamodb:Scan
    - dynamodb:Query
    - dynamodb:GetItem
  Resource: "arn:aws:dynamodb:${self:provider.region}:*:table/${self:custom.db_table}"
- Effect: "Allow"
  Action:
    - dynamodb:PutItem
  Resource: "arn:aws:dynamodb:${self:provider.region}:*:table/${self:custom.db_table}"
  Condition:
    "ForAllValues:StringEquals":
      "dynamodb:LeadingKeys": ["U#${cognito-identity.amazonaws.com:sub}", "U#${cognito-identity.amazonaws.com:sub}#O", "U#${cognito-identity.amazonaws.com:sub}#P"]
- Effect: Allow
  Action:
    - s3:*
  Resource: ${self:custom.s3_role_resource}
